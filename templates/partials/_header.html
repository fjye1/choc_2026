<header class="navbar-bg-header m-0 p-0">
  <div class="container">
    <div class="navbar-grid">

      <!-- MOBILE PROFILE ICON (under 900px) -->
      <div class="left-section show-under-900">
        {% if current_user.is_authenticated %}
        <a href="{{ url_for('profile') }}">
          <img src="{{ current_user.email | gravatar }}"
               alt="Profile"
               height="30"
               class="rounded-circle">
        </a>
        {% else %}
        <a href="{{ url_for('login.login') }}">
          <img src="{{ url_for('static', filename='images/profile_guest.svg') }}"
               alt="Guest Profile"
               width="40"
               height="40">
        </a>
        {% endif %}
      </div>

      <!-- DESKTOP NAV (over 900px) -->
      <div class="left-section hide-under-900">
        <ul class="nav mb-0">
          {% if admin %}
          <li><a href="{{ url_for('admin') }}" class="nav-link px-2 link-secondary">Admin</a></li>
          {% endif %}
          {% if not current_user.is_authenticated %}
<!--          TODO alter this section here to render the register route. -->
          <li><a href="{{ url_for('login.login') }}" class="nav-link px-2 link-secondary">Register</a></li>
          <li><a href="{{ url_for('login.login') }}" class="nav-link px-2 link-body-emphasis">Login</a></li>
          {% endif %}
          <li><a href="{{ url_for('home.index') }}" class="nav-link px-2 link-body-emphasis">Home</a></li>
          <li><a href="{{ url_for('products.product_test') }}" class="nav-link px-2 link-body-emphasis">Products</a></li>
        </ul>
      </div>

      <!-- CENTER LOGO -->
      <div class="center-logo">
        <a href="{{ url_for('home.index') }}">
          <picture>
            <source media="(max-width: 900px)"
                    srcset="{{ url_for('static', filename='images/mobile_logo_small.png') }}">
            <img src="{{ url_for('static', filename='images/Logo_small.png') }}"
                 alt="Site Logo"
                 loading="lazy"
                 class="lazy-swap product-img">
          </picture>
        </a>
      </div>

      <!-- RIGHT SECTION (Search + Profile + Cart) -->
      <div class="right-section">
        <div class="hide-under-900 d-flex align-items-center gap-3">
          {% include 'partials/search_form.html' %}
          {% include 'partials/user_dropdown.html' %}
        </div>

        {% include 'partials/cart_icon.html' %}
      </div>
    </div>
  </div>
</header>

{% include 'partials/categories_nav.html' %}